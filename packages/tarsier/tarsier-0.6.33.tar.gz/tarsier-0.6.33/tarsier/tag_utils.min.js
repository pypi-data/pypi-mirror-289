"use strict";const tarsierId="__tarsier_id",tarsierSelector=`#${tarsierId}`,reworkdVisibilityAttr="reworkd-original-visibility",elIsVisible=t=>{const n=t.getBoundingClientRect(),e=window.getComputedStyle(t),i=e.visibility==="hidden"||e.display==="none"||t.hidden||t.hasAttribute("disabled")&&t.getAttribute("disabled"),s=e.opacity==="0"&&!hasLabel(t),a=n.width===0||n.height===0,r=t.tagName==="SCRIPT"||t.tagName==="STYLE";return!i&&!s&&!a&&!r};function hasLabel(t){if(!["input","textarea","select","button"].includes(t.tagName.toLowerCase()))return!1;const e=CSS.escape(t.id);if(document.querySelector(`label[for="${e}"]`))return!0;const o=Array.from(t.parentElement?.children||[]);for(let s of o)if(s.tagName.toLowerCase()==="label")return!0;return!1}const isNonWhiteSpaceTextNode=t=>t.nodeType===Node.TEXT_NODE&&t.textContent&&t.textContent.trim().length>0&&t.textContent.trim()!=="\u200B",inputs=["a","button","textarea","select","details","label"],isInteractable=t=>t.tagName.toLowerCase()==="label"&&t.querySelector("input")?!1:inputs.includes(t.tagName.toLowerCase())||t.tagName.toLowerCase()==="input"&&t.type!=="hidden"||t.role==="button",text_input_types=["text","password","email","search","url","tel","number"],isTextInsertable=t=>t.tagName.toLowerCase()==="textarea"||t.tagName.toLowerCase()==="input"&&text_input_types.includes(t.type),textLessTagWhiteList=["input","textarea","select","button"],isTextLess=t=>{const n=t.tagName.toLowerCase();if(textLessTagWhiteList.includes(n)||t.childElementCount>0)return!1;if("innerText"in t&&t.innerText.trim().length===0){const e=t.querySelector("svg"),i=t.querySelector("img");return e||i?!1:isElementInViewport(t)}return!1};function isElementInViewport(t){const n=t.getBoundingClientRect();return n.top>=0&&n.left>=0&&n.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&n.right<=(window.innerWidth||document.documentElement.clientWidth)}function getElementXPath(t){let n=[],e="";for(t&&t.ownerDocument!==window.document&&(e=`iframe[${t.getAttribute("iframe_index")}]`);t;){if(!t.tagName){t=t.parentNode;continue}let i=t.tagName.toLowerCase(),o=window.fixNamespaces(i),s=1,a=t.previousElementSibling;for(;a;)a.tagName===t.tagName&&s++,a=a.previousElementSibling;let r=t.nextElementSibling,p=!1;for(;r;){if(r.tagName===t.tagName){p=!0;break}r=r.nextElementSibling}if((s>1||p)&&(o+=`[${s}]`),t.id){if(o+=`[@id="${t.id}"]`,n.length>3)return n.unshift(o),"//"+n.join("/")}else t.className&&(o+=`[@class="${t.className}"]`);n.unshift(o),t=t.parentNode}return e+"//"+n.join("/")}function create_tagged_span(t,n){let e;isInteractable(n)?isTextInsertable(n)?e=`[#${t}]`:n.tagName.toLowerCase()=="a"?e=`[@${t}]`:e=`[$${t}]`:e=`[${t}]`;let i=document.createElement("span");return i.id=tarsierId,i.style.position="relative",i.style.display="inline",i.style.color="white",i.style.backgroundColor="red",i.style.padding="1.5px",i.style.borderRadius="3px",i.style.fontWeight="bold",i.style.fontFamily="Arial",i.style.margin="1px",i.style.lineHeight="1.25",i.style.letterSpacing="2px",i.style.zIndex="2140000046",i.style.clip="auto",i.style.height="fit-content",i.style.width="fit-content",i.style.minHeight="fit-content",i.style.minWidth="fit-content",i.style.maxHeight="unset",i.style.maxWidth="unset",i.textContent=e,i.style.webkitTextFillColor="white",i.style.textShadow="",i.style.textDecoration="none",i.style.letterSpacing="0px",i}window.tagifyWebpage=(t=!1)=>{window.removeTags(),hideMapElements();const n=getAllElementsInAllFrames(),e=getElementsToTag(n,t),i=removeNestedTags(e),o=insertTags(i,t);return absolutelyPositionMissingTags(),o};function getAllElementsInAllFrames(){const t=Array.from(document.body.querySelectorAll("*")),n=document.getElementsByTagName("iframe");for(let e=0;e<n.length;e++)try{const i=n[e],o=i.contentDocument||i.contentWindow?.document;if(!o)continue;const s=Array.from(o.querySelectorAll("*"));s.forEach(a=>a.setAttribute("iframe_index",e.toString())),t.push(...s)}catch(i){console.error("Error accessing iframe content:",i)}return t}function getElementsToTag(t,n){const e=[];for(let i of t)isTextLess(i)||!elIsVisible(i)||(isInteractable(i)||n&&Array.from(i.childNodes).filter(isNonWhiteSpaceTextNode).length>=1)&&e.push(i);return e}function removeNestedTags(t){const n=[...t];return t.map(e=>{if(isInteractable(e)){const i=[];if(e.querySelectorAll("*").forEach(o=>{n.indexOf(o)>-1&&i.push(o)}),i.length==1)for(let o of i)n.splice(n.indexOf(o),1)}}),n}function insertTags(t,n){const e={};let i=0;for(let o of t){e[i]=getElementXPath(o);let s=create_tagged_span(i,o);if(isInteractable(o))isTextInsertable(o)&&o.parentElement?o.parentElement.insertBefore(s,o):o.prepend(s),i++;else if(n)for(let a of Array.from(o.childNodes).filter(isNonWhiteSpaceTextNode)){let r=create_tagged_span(i,o);o.insertBefore(r,a),i++}}return e}function absolutelyPositionMissingTags(){const n=document.querySelectorAll(tarsierSelector);n.forEach(e=>{const i=e.parentElement,o=i.getBoundingClientRect();let s=e.getBoundingClientRect();const a={x:(o.left+o.right)/2,y:(o.top+o.bottom)/2},r={x:(s.left+s.right)/2,y:(s.top+s.bottom)/2},p=Math.abs(a.x-r.x),g=Math.abs(a.y-r.y);if(p>500||g>500||!elIsVisible(e)){e.style.position="absolute";let l=Math.max(0,o.left-(s.right+3-s.left));l=Math.min(l,window.innerWidth-(s.right-s.left));let c=Math.max(0,o.top+3);c=Math.min(c,Math.max(window.innerHeight,document.documentElement.scrollHeight)-(s.bottom-s.top)),e.style.left=`${l}px`,e.style.top=`${c}px`,i.removeChild(e),document.body.appendChild(e)}n.forEach(l=>{if(e===l)return;let c=l.getBoundingClientRect(),d=parseFloat(window.getComputedStyle(e).fontSize.split("px")[0]),m=parseFloat(window.getComputedStyle(l).fontSize.split("px")[0]);for(;s.left<c.right&&s.right>c.left&&s.top<c.bottom&&s.bottom>c.top&&d>7&&m>7;)d-=.5,m-=.5,e.style.fontSize=`${d}px`,l.style.fontSize=`${m}px`,s=e.getBoundingClientRect(),c=l.getBoundingClientRect()})})}window.removeTags=()=>{document.querySelectorAll(tarsierSelector).forEach(n=>n.remove()),showMapElements()};const GOOGLE_MAPS_OPACITY_CONTROL="__reworkd_google_maps_opacity",hideMapElements=()=>{const t=['iframe[src*="google.com/maps"]','iframe[id*="gmap_canvas"]',".maplibregl-map",".mapboxgl-map",".leaflet-container",'img[src*="maps.googleapis.com"]','[aria-label="Map"]',".cmp-location-map__map",'.map-view[data-role="mapView"]',".google_Map-wrapper",".google_map-wrapper",".googleMap-wrapper",".googlemap-wrapper",".ls-map-canvas",".gmapcluster","#googleMap","#googleMaps","#googlemaps","#googlemap","#google_map","#google_maps","#MapId",".geolocation-map-wrapper",".locatorMap"];document.querySelectorAll(t.join(", ")).forEach(n=>{const e=window.getComputedStyle(n).opacity;n.setAttribute("data-original-opacity",e),n.style.opacity="0"})},showMapElements=()=>{document.querySelectorAll(`[${GOOGLE_MAPS_OPACITY_CONTROL}]`).forEach(n=>{n.style.opacity=n.getAttribute("data-original-opacity")||"1"})};window.hideNonTagElements=()=>{getAllElementsInAllFrames().forEach(n=>{const e=n;e.style.visibility&&e.setAttribute(reworkdVisibilityAttr,e.style.visibility),e.id.startsWith(tarsierId)?e.style.visibility="visible":e.style.visibility="hidden"})},window.fixNamespaces=t=>{const n=/^[a-zA-Z_][\w\-.]*:[a-zA-Z_][\w\-.]*$/,e=t.split(/[#.]/)[0];return n.test(e)?t.replace(e,`*[name()="${e}"]`):t},window.revertVisibilities=()=>{getAllElementsInAllFrames().forEach(n=>{const e=n;e.getAttribute(reworkdVisibilityAttr)?e.style.visibility=e.getAttribute(reworkdVisibilityAttr)||"true":e.style.removeProperty("visibility")})};
