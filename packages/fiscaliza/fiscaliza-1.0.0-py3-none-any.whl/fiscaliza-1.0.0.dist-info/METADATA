Metadata-Version: 2.1
Name: fiscaliza
Version: 1.0.0
Summary: Implementa√ß√£o de API python a inst√¢ncia do Redmine da Anatel: Fiscaliza
Home-page: https://github.com/InovaFiscaliza/fiscaliza
Author: ronaldokun
Author-email: ronaldokun@gmail.com
License: Apache Software License 2.0
Keywords: nbdev jupyter notebook python
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: Natural Language :: English
Classifier: Programming Language :: Python :: 3.10
Classifier: License :: OSI Approved :: Apache Software License
Requires-Python: >=3.10
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: python-redmine ==2.4.0
Requires-Dist: fastcore >=1.5.46
Requires-Dist: unidecode >=1.3.8
Requires-Dist: python-dotenv >=1.0.1
Provides-Extra: dev

# API para relato no Fiscaliza da Anatel


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

``` python
import os
import random
from random import randint
from dotenv import load_dotenv
from fiscaliza.main import Fiscaliza
from fiscaliza.constants import MUNICIPIOS, SERVICOS
from fiscaliza.attrs import FIELDS
load_dotenv(override=True)
```

    True

## Autentica√ß√£o e Conex√£o com o servidor do Redmine

A classe
[`Fiscaliza`](https://InovaFiscaliza.github.io/fiscaliza/main.html#fiscaliza)
√© somente para efetuar a conex√£o e autentica√ß√£o com o servidor do
Redmine.

``` python
issue_id = "124182"
fiscaliza = Fiscaliza(os.environ["USERNAME"], os.environ["PASSWORD"], teste=True)
issue = fiscaliza.get_issue(issue_id)
```

## Conex√£o com dada inspe√ß√£o

O m√©todo `get_issue` instancia e retorna um objeto do tipo
[`Issue`](https://InovaFiscaliza.github.io/fiscaliza/main.html#issue),
este que encapsula a funcionalidade principal de resgate de informa√ß√µes,
valida√ß√£o e formata√ß√£o de informa√ß√µes e atualiza√ß√£o de inspe√ß√£o. O mesmo
objeto pode ser instanciado diretamente passando o `client` do objeto
[`Fiscaliza`](https://InovaFiscaliza.github.io/fiscaliza/main.html#fiscaliza)
ap√≥s autenticado e o `id` da inspe√ß√£o.

    issue = Issue(fiscaliza.client, issue_id)

## Informa√ß√µes da Inspe√ß√£o

Todas as informa√ß√µes principais da Inspe√ß√£o est√£o dispon√≠veis atrav√©s do
atributo `attrs`

``` python
issue.attrs
```

    {'acao': {'type': 'acao_de_inspecao',
      'status': 'Em andamento',
      'name': 'ACAO_GR08_2024_0014',
      'description': '[PMEC 2024 Etapa 2] Monitorar canais e faixas de frequ√™ncias relacionados √†s aplica√ß√µes cr√≠ticas (como, por exemplo, radionavega√ß√£o e radiocomunica√ß√£o aeron√°utica e canais de emerg√™ncia) na forma a ser estabelecida no Plano de A√ß√£o de Fiscaliza√ß√£o.\r\n'},
     'agrupamento': '',
     'allowed_statuses': '',
     'anexos': ['https://sistemasnethm/fiscaliza/attachments/download/9190/Info.json',
      'https://sistemasnethm/fiscaliza/attachments/download/9191/Info.json'],
     'ano_de_execucao': 2024,
     'app_fiscaliza': 0,
     'assigned_to': 'Eric Magalh√£es Delgado',
     'atualizacao': 'Atualizada por Ronaldo da Silva Alves Batista em 25/07/2024 √†s 05:05:36',
     'author': 'Eric Magalh√£es Delgado',
     'changesets': '',
     'children': '',
     'classe_da_inspecao': 'T√©cnica',
     'closed_on': '',
     'coordenacao_responsavel': 'FI2',
     'created_on': '2024-04-18T12:38:03Z',
     'data_de_inicio_efetivo': '2024-07-25',
     'description': '[PMEC 2024 Etapa 2] Monitorar canais e faixas de frequ√™ncias relacionados √†s aplica√ß√µes cr√≠ticas (como, por exemplo, radionavega√ß√£o e radiocomunica√ß√£o aeron√°utica e canais de emerg√™ncia) na forma a ser estabelecida no Plano de A√ß√£o de Fiscaliza√ß√£o.\r\n',
     'done_ratio': 0,
     'due_date': '2024-05-30',
     'entidade_da_inspecao': [],
     'estimated_hours': '',
     'fiscais': ['Eric Magalh√£es Delgado', 'Ronaldo da Silva Alves Batista'],
     'fiscal_responsavel': 'Eric Magalh√£es Delgado',
     'horas_de_conclusao': 2,
     'horas_de_deslocamento': 3,
     'horas_de_execucao': 29,
     'horas_de_preparacao': 1,
     'id': 124182,
     'irregularidade': [],
     'is_private': False,
     'membros': ['Gilmar Ferreira do Nascimento',
      'Luis Fernando Camelier de Queiroz',
      'Michel Kulhavy Cerqueira',
      'Iulo de Ara√∫jo Lima Lobo',
      'Carlos Fernando Muniz Santos',
      'Isabel Cristina Cruz Soares e Souza',
      'Alessandro Vasconcelos Fernandes',
      'Anecy Oliveira de Freitas',
      'Wilton Machado de Oliveira',
      'Ilva Perla Monteiro Ferreira',
      'Lin Yu Wan',
      'Alexnaldo Cerqueira da Silva',
      'Jorgean Ferreira Leal',
      'Jos√© Mauricio Leite Ara√∫jo',
      'Arildo Oliva Franca Filho',
      'Leonardo Lago Ara√∫jo',
      'Brasilio Rios Leite',
      'Fiscal UD',
      'Jos√© Ivan Gomes',
      'Jaqueline Cesario da Silva',
      'Eric Magalh√£es Delgado',
      'Ronaldo da Silva Alves Batista'],
     'no_fiscaliza_issue': {'numero': '124182',
      'link_acesso': 'https://sistemasnethm/fiscaliza/issues/124182'},
     'no_pcdp': '',
     'no_sav': 'Teste de Quebra\n de linha',
     'no_sei_processo_fiscalizacao': "{'numero': '53554.000005/2024-18', 'link_acesso': 'https://seihm.anatel.gov.br/sei/controlador.php?acao=procedimento_trabalhar&id_procedimento=1982134'}",
     'numero_do_pai': 123456,
     'observacao_tecnica_amostral': 'Simula√ß√£o com o HTZ',
     'pai_instaurado_pela_anatel': 'Sim',
     'precisa_reservar_instrumentos': 0,
     'priority': 'Normal',
     'procedimentos': ['An√°lise/coleta de Dados'],
     'project': 'GR08',
     'servicos_da_inspecao': ['099 - RESTRITO - SERVI√áO DE RADIA√á√ÉO RESTRITA',
      '032 - COLETIVO - RADIOENLACES ASSOCIADOS AO SERVI√áO REDE TRANSPORTE TELECOMUNICA√á√ÉO'],
     'situacao_constatada': 'Irregular',
     'spent_hours': 0.0,
     'start_date': '2024-03-01',
     'status': 'Relatando',
     'subject': 'INSP_GR08_2024_0147',
     'subtema': ['Radiomonitora√ß√£o Terrestre'],
     'tema': ['Uso do Espectro'],
     'time_entries': '',
     'tipo_de_inspecao': 'Outorga - Aspectos n√£o T√©cnicos',
     'total_de_horas': 35.0,
     'total_estimated_hours': '',
     'total_spent_hours': 0.0,
     'tracker': 'Atividade de Inspe√ß√£o',
     'ufmunicipio': ['MG/Bocaina de Minas', 'AL/Uni√£o dos Palmares'],
     'updated_on': '2024-07-25T08:05:36Z',
     'utilizou_algum_instrumento': 0,
     'utilizou_tecnicas_amostrais': 'Usou t√©cnicas amostrais',
     'watchers': ''}

O atributo acima retorna um dicion√°rio com atributos atuais da Inspe√ß√£o
no Fiscaliza. Existem campos edit√°veis atrav√©s da API ou da interface
Web e outros meramente informativos, al√©m de alguns campos presentes no
`Redmine` mas sem uso na inst√¢ncia Fiscaliza da Anatel. Um exemplo
desses √© o atributo `children`, sempre vazio.

## Campos edit√°veis

Os dados que s√£o edit√°veis, tanto pela API quanto pela interface web
aparecem em `min√∫sculo` no dicion√°rio. Para estes dados temos um outro
m√©todo mais informativo:

``` python
issue.editable_fields
```

    {'status': (value: Rascunho),
     'description': (value: [PMEC 2024 Etapa 2] Monitorar canais e faixas de frequ√™ncias relacionados √†s aplica√ß√µes cr√≠ticas (como, por exemplo, radionavega√ß√£o e radiocomunica√ß√£o aeron√°utica e canais de emerg√™ncia) na forma a ser estabelecida no Plano de A√ß√£o de Fiscaliza√ß√£o.
     ) | <mandatory>,
     'start_date': (value: 2024-03-01) | <mandatory>,
     'due_date': (value: 2024-11-30) | <mandatory>,
     'tipo_de_inspecao': (value: ) | <mandatory>, <options>, conditional,
     'fiscal_responsavel': (value: ) | <mandatory>, <options>,
     'fiscais': (value: []) | <mandatory>, <multiple>, <options>,
     'entidade_da_inspecao': (value: []), <multiple>,
     'ufmunicipio': (value: []) | <mandatory>, <multiple>, <options>,
     'servicos_da_inspecao': (value: []) | <mandatory>, <multiple>, <options>,
     'procedimentos': (value: []) | <mandatory>, <multiple>, <options>, conditional,
     'horas_de_preparacao': (value: 0) | <mandatory>,
     'horas_de_deslocamento': (value: 0) | <mandatory>,
     'horas_de_execucao': (value: 0) | <mandatory>,
     'horas_de_conclusao': (value: 0) | <mandatory>,
     'no_sav': (value: ),
     'no_pcdp': (value: ),
     'coordenacao_responsavel': (value: FI2), <options>,
     'agrupamento': (value: ),
     'no_sei_processo_fiscalizacao': ({'numero': '53554.000005/2024-18', 'link_acesso': 'https://seihm.anatel.gov.br/sei/controlador.php?acao=procedimento_trabalhar&id_procedimento=1982134'}),
     'precisa_reservar_instrumentos': (value: ) | <mandatory>, <options>, conditional,
     'utilizou_algum_instrumento': (value: ) | <mandatory>, <options>, conditional,
     'utilizou_tecnicas_amostrais': (value: ) | <mandatory>, <options>,
     'observacao_tecnica_amostral': (value: ) | <mandatory>}

Nesse caso as chaves s√£o os nomes dos campos e os valores s√£o os objetos
que modelam o campo. Ao mostrar ou imprimir o dicion√°rio, como mostrado
acima, √© impresso o valor atual do campo entre par√™nteses.

    'tipo_de_inspecao': (value: Uso do Espectro - N√£o Outorgado) | <mandatory>, <options>, conditional

Separado pela barra vertical s√£o mostrados alguns atributos do campo:

- `<mandatory>` Atributo booleano indicando se o campo √© obrigat√≥rio;
- `<multiple>` Atributo booleano. `False`: Campo de valor √∫nico. `True`
  Campo aceita mais de um valor e por conseguinte deve ser fornecido uma
  lista em vez de um valor at√¥mico ( `int`, `float`, `str` );
- `<options>` Atributo do tipo lista. Quando presente sinaliza que o
  campo √© restrito e s√≥ aceita valores pr√©-definidos;
- `conditional` Esse n√£o √© um atributo, somente um sinalizador indicando
  que o campo √© condicional e para dado valor preenchido neste campo,
  ficam dispon√≠veis outros campos, estes podem ser obrigat√≥rios e
  inclusive condicionais.

O valor em si do campo √© guardado no atributo `value`, acessado atrav√©s
da nota√ß√£o de ponto

``` python
issue.editable_fields['tipo_de_inspecao'].value
```

    'Outorga - Aspectos n√£o T√©cnicos'

### Campos Obrigat√≥rios e Condicionais

Os dois m√©todos a seguir filtram, dentre os campos edit√°veis, os campos
obrigat√≥rio e condicionais:

``` python
issue.mandatory_fields()
```

    {'description': (value: [PMEC 2024 Etapa 2] Monitorar canais e faixas de frequ√™ncias relacionados √†s aplica√ß√µes cr√≠ticas (como, por exemplo, radionavega√ß√£o e radiocomunica√ß√£o aeron√°utica e canais de emerg√™ncia) na forma a ser estabelecida no Plano de A√ß√£o de Fiscaliza√ß√£o.
     ) | <mandatory>,
     'start_date': (value: 2024-03-01) | <mandatory>,
     'due_date': (value: 2024-05-30) | <mandatory>,
     'tipo_de_inspecao': (value: Outorga - Aspectos n√£o T√©cnicos) | <mandatory>, <options>, conditional,
     'fiscal_responsavel': (value: Eric Magalh√£es Delgado) | <mandatory>, <options>,
     'fiscais': (value: ['Eric Magalh√£es Delgado', 'Ronaldo da Silva Alves Batista']) | <mandatory>, <multiple>, <options>,
     'ufmunicipio': (value: ['MG/Bocaina de Minas', 'AL/Uni√£o dos Palmares']) | <mandatory>, <multiple>, <options>,
     'servicos_da_inspecao': (value: ['099 - RESTRITO - SERVI√áO DE RADIA√á√ÉO RESTRITA', '032 - COLETIVO - RADIOENLACES ASSOCIADOS AO SERVI√áO REDE TRANSPORTE TELECOMUNICA√á√ÉO']) | <mandatory>, <multiple>, <options>,
     'situacao_constatada': (value: Irregular) | <mandatory>, <options>,
     'procedimentos': (value: ['An√°lise/coleta de Dados']) | <mandatory>, <multiple>, <options>, conditional,
     'horas_de_preparacao': (value: 1) | <mandatory>,
     'horas_de_deslocamento': (value: 3) | <mandatory>,
     'horas_de_execucao': (value: 29) | <mandatory>,
     'horas_de_conclusao': (value: 2) | <mandatory>,
     'pai_instaurado_pela_anatel': (value: Sim) | <mandatory>, <options>, conditional,
     'precisa_reservar_instrumentos': (value: 0) | <mandatory>, <options>, conditional,
     'utilizou_algum_instrumento': (value: 0) | <mandatory>, <options>, conditional,
     'utilizou_tecnicas_amostrais': (value: Usou t√©cnicas amostrais) | <mandatory>, <options>,
     'observacao_tecnica_amostral': (value: Simula√ß√£o com o HTZ) | <mandatory>}

``` python
issue.conditional_fields()
```

    {'tipo_de_inspecao': (value: Outorga - Aspectos n√£o T√©cnicos) | <mandatory>, <options>, conditional,
     'procedimentos': (value: ['An√°lise/coleta de Dados']) | <mandatory>, <multiple>, <options>, conditional,
     'pai_instaurado_pela_anatel': (value: Sim) | <mandatory>, <options>, conditional,
     'precisa_reservar_instrumentos': (value: 0) | <mandatory>, <options>, conditional,
     'utilizou_algum_instrumento': (value: 0) | <mandatory>, <options>, conditional}

> O conjunto de valores para os campos com op√ß√µes pr√©-definidas est√£o
> relacionados no atributo `.options`

``` python
issue.editable_fields['tipo_de_inspecao'].options
```

    ['',
     'Bloqueio Administrativo',
     'Certifica√ß√£o',
     'Medi√ß√£o de CEMRF (RNI)',
     'Outorga - Aspectos n√£o T√©cnicos',
     'Outorga - Aspectos T√©cnicos',
     'Uso do Espectro - Interfer√™ncia',
     'Uso do Espectro - Monitora√ß√£o',
     'Uso do Espectro - N√£o Outorgado']

``` python
issue.editable_fields['procedimentos'].options
```

    ['Nenhum',
     'Lacra√ß√£o',
     'Apreens√£o',
     'Interrup√ß√£o',
     'N√£o Cadastrado',
     'Notificado',
     'A Notificar',
     'Libera√ß√£o/Desinterrup√ß√£o',
     'Orienta√ß√£o ao Usu√°rio',
     'Comunicado',
     'Deslacrado',
     'Vistoriado',
     'Emiss√£o Termo Viola√ß√£o de Lacre',
     'Apoio a busca e apreens√£o',
     'Investiga√ß√£o/Pesquisa',
     'N√£o Lacrado - Impedimento',
     'N√£o Lacrado - Amparo Judicial',
     'N√£o Lacrado - Respons√°vel Ausente',
     'N√£o Lacrado - Local Fechado',
     'Constata√ß√£o Viola√ß√£o Lacre/Relacrado',
     'Constata√ß√£o Viola√ß√£o Lacre/Impedimento',
     'Not√≠cia Crime',
     'Monitorado alterado',
     'Constata√ß√£o Encerramento - Informe',
     'Levantamento de Dados',
     'An√°lise/coleta de Dados',
     'Monitorado',
     'N√£o Lacrado - Desativado',
     'Devolu√ß√£o de Produto(s)',
     'Outros']

## Atualizando os campos edit√°veis da Inspe√ß√£o

Dada a exist√™ncia de campos condicionais, para obtermos todos os campos
edit√°veis para dado tipo de inspe√ß√£o, √© preciso fornecer um dicion√°rio
de dados para que os campos sejam atualizados de acordo com os valores
fornecidos para os campos condicionais.

``` python
dados = {
    "tipo_de_inspecao": "Certifica√ß√£o",
    "precisa_reservar_instrumentos": "0",
    "utilizou_algum_instrumento": "0",
    "procedimentos": "Lacra√ß√£o",
}
```

A atualiza√ß√£o dos campos √© feita passando o dicion√°rio para o m√©todo
`update_fields`.

``` python
issue.update_fields(dados)
```

Depois de atualizado os campos com o m√©todo acima, checamos novamente o
atributo `editable_fields`

``` python
issue.editable_fields
```

    {'status': (value: Relatando),
     'description': (value: [PMEC 2024 Etapa 2] Monitorar canais e faixas de frequ√™ncias relacionados √†s aplica√ß√µes cr√≠ticas (como, por exemplo, radionavega√ß√£o e radiocomunica√ß√£o aeron√°utica e canais de emerg√™ncia) na forma a ser estabelecida no Plano de A√ß√£o de Fiscaliza√ß√£o.
     ) | <mandatory>,
     'start_date': (value: 2024-03-01) | <mandatory>,
     'due_date': (value: 2024-05-30) | <mandatory>,
     'tipo_de_inspecao': (value: Certifica√ß√£o) | <mandatory>, <options>, conditional,
     'fiscal_responsavel': (value: Eric Magalh√£es Delgado) | <mandatory>, <options>,
     'fiscais': (value: ['Eric Magalh√£es Delgado', 'Ronaldo da Silva Alves Batista']) | <mandatory>, <multiple>, <options>,
     'entidade_da_inspecao': (value: []), <multiple>,
     'ufmunicipio': (value: ['MG/Bocaina de Minas', 'AL/Uni√£o dos Palmares']) | <mandatory>, <multiple>, <options>,
     'servicos_da_inspecao': (value: ['099 - RESTRITO - SERVI√áO DE RADIA√á√ÉO RESTRITA', '032 - COLETIVO - RADIOENLACES ASSOCIADOS AO SERVI√áO REDE TRANSPORTE TELECOMUNICA√á√ÉO']) | <mandatory>, <multiple>, <options>,
     'situacao_constatada': (value: Irregular) | <mandatory>, <options>,
     'procedimentos': (value: ['Lacra√ß√£o']) | <mandatory>, <multiple>, <options>, conditional,
     'irregularidade': (value: []), <multiple>, <options>,
     'horas_de_preparacao': (value: 1) | <mandatory>,
     'horas_de_deslocamento': (value: 3) | <mandatory>,
     'horas_de_execucao': (value: 29) | <mandatory>,
     'horas_de_conclusao': (value: 2) | <mandatory>,
     'no_sav': (value: Teste de Quebra
      de linha),
     'no_pcdp': (value: ),
     'pai_instaurado_pela_anatel': (value: Sim) | <mandatory>, <options>, conditional,
     'coordenacao_responsavel': (value: FI2), <options>,
     'numero_do_pai': (value: 123456),
     'agrupamento': (value: ),
     'no_sei_processo_fiscalizacao': ({'numero': '53554.000005/2024-18', 'link_acesso': 'https://seihm.anatel.gov.br/sei/controlador.php?acao=procedimento_trabalhar&id_procedimento=1982134'}),
     'precisa_reservar_instrumentos': (value: 0) | <mandatory>, <options>, conditional,
     'utilizou_algum_instrumento': (value: 0) | <mandatory>, <options>, conditional,
     'utilizou_tecnicas_amostrais': (value: Usou t√©cnicas amostrais) | <mandatory>, <options>,
     'observacao_tecnica_amostral': (value: Simula√ß√£o com o HTZ) | <mandatory>}

Caso o conjunto de dados j√° seja conhecido para dado tipo de inspe√ß√£o,
basta passar o dicion√°rio diretamente para o m√©todo `update`.
Internamente os m√©todos mostrados anteriormente de atualiza√ß√£o dos
campos s√£o chamados.

## Exemplo completo

O dicion√°rio a seguir cont√©m valores misturados de diversos tipos de
inspe√ß√£o distintos, al√©m de valores aleatorizados. A API simplesmente
filtra os valores que se aplicam para o tipo de inspe√ß√£o solicitada e o
valor do dado fornecido para os campos condicionais. As demais chaves
que n√£o se aplicam s√£o ignoradas.

<details class="code-fold">
<summary>Code</summary>

``` python
dados = {
    "endereco_da_inspecao": "Rua Machado de Assis, 27 - Morro Grande, Rio de Janeiro - RJ",
    "campo_eletrico__pico_vm": randint(50, 100),
    "campo_eletrico_rms_vm": randint(20, 100),
    "coordenacao_responsavel": "FI2",
    "cnpjcpf_da_entidade": "27865757000102",
    "entidade_com_cadastro_stel": "N√£o",
    "entidade_outorgada": randint(0, 1),
    "esta_em_operacao": randint(0, 1),
    "numero_da_estacao": "1493671",
    "fiscais": ["Eric Magalh√£es Delgado", "Ronaldo da Silva Alves Batista"],
    "fiscal_responsavel": "Eric Magalh√£es Delgado",
    "foi_constatada_interferencia": randint(0, 1),
    "frequencia_inicial": randint(70, 110),
    "frequencia_final": randint(110, 117),
    "gerar_relatorio": randint(0, 1),
    "gerar_plai": randint(0, 1),
    "tipo_do_processo_plai": random.choice(FIELDS["tipo_do_processo_plai"].options),
    "coord_fi_plai": random.choice(FIELDS["coord_fi_plai"].options),
    "html_path": "/mnt/c/Users/rsilva/code/fiscaliza/tests/Report_2024.02.18_T11.30.55_123456.html",
    "uploads": [
        {
            "path": "/mnt/c/Users/code/fiscaliza/tests/Report_2024.02.18_T11.30.55_123456.json",
            "filename": "Info.json",
        }
    ],
    "identificada_a_origem": str(randint(0, 1)),
    "unidade_da_frequencia_final": "MHz",
    "unidade_da_frequencia_inicial": "MHz",
    "horas_de_conclusao": randint(1, 8),
    "horas_de_deslocamento": randint(1, 8),
    "horas_de_execucao": randint(8, 40),
    "horas_de_preparacao": randint(1, 8),
    "houve_obice": random.randint(0, 1),
    "houve_interferencia": random.choice(["Sim", "N√£o"]),
    "latitude_coordenadas": -randint(0, 33),
    "longitude_coordenadas": -randint(34, 73),
    "latitude_da_estacao": -randint(0, 33),
    "longitude_da_estacao": -randint(34, 73),
    "nome_da_entidade": "Globo S/A",
    "numero_do_pai": "123456",
    "observacao_tecnica_amostral": "Simula√ß√£o com o HTZ",
    "pai_instaurado_pela_anatel": random.choice(["Sim", "N√£o"]),
    "precisa_reservar_instrumentos": "0",  #
    "procedimentos": random.choices(FIELDS["procedimentos"].options, k=2),  #
    "qnt_produt_lacradosapreend": "0",
    "reserva_de_instrumentos": "0",
    "no_sav": "Teste de Quebra\n de linha",
    "documento_instaurador_do_pado": "0201235\n0201239\n0201237",
    "no_do_lacre": "50",
    "motivo_de_lai": random.choice(FIELDS["motivo_de_lai"].options),
    "no_sei_do_aviso_lai": "",
    "sanada_ou_mitigada": random.choice(["0", "1"]),
    "servicos_da_inspecao": random.choices(list(SERVICOS.values()), k=2),
    "situacao_constatada": "Irregular",
    "situacao_de_risco_a_vida": "Sim",
    "tipo_de_inspecao": random.choice(FIELDS["tipo_de_inspecao"].options),
    "ufmunicipio": random.choices(MUNICIPIOS, k=2),
    "uso_de_produto_homologado": random.choice(["0", "1"]),
    "utilizou_algum_instrumento": "0",
    "utilizou_apoio_policial": random.choice(FIELDS["utilizou_apoio_policial"].options),
    "utilizou_tecnicas_amostrais": random.choice(
        FIELDS["utilizou_tecnicas_amostrais"].options
    ),
    "description": "[PMEC 2024 Etapa 2] Monitorar canais e faixas de frequ√™ncias relacionados √†s aplica√ß√µes cr√≠ticas (como, por exemplo, radionavega√ß√£o e radiocomunica√ß√£o aeron√°utica e canais de emerg√™ncia) na forma a ser estabelecida no Plano de A√ß√£o de Fiscaliza√ß√£o.\r\n",
    "start_date": "2024-03-01",
    "due_date": "2024-05-30",
}
```

</details>

``` python
issue.update(dados)
```

    ValueError: Arquivo C:\Users\rsilva\code\fiscaliza\tests\Report_2024.02.18_T11.30.55_123456.json n√£o existe ou n√£o √© um arquivo
    [0;31m---------------------------------------------------------------------------[0m
    [0;31mValueError[0m                                Traceback (most recent call last)
    Cell [0;32mIn[18], line 1[0m
    [0;32m----> 1[0m [43missue[49m[38;5;241;43m.[39;49m[43mupdate[49m[43m([49m[43mdados[49m[43m)[49m

    File [0;32m~/anatel/fiscaliza/fiscaliza/main.py:577[0m, in [0;36mIssue.update[0;34m(self, dados)[0m
    [1;32m    575[0m     [38;5;28mself[39m[38;5;241m.[39mclient[38;5;241m.[39missue[38;5;241m.[39mupdate([38;5;28mself[39m[38;5;241m.[39mid, status_id[38;5;241m=[39mstatus_id, [38;5;241m*[39m[38;5;241m*[39mdata)
    [1;32m    576[0m [38;5;28;01melse[39;00m:
    [0;32m--> 577[0m     data [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_parse_value_dict[49m[43m([49m[43mdados[49m[43m)[49m
    [1;32m    578[0m     [38;5;28mself[39m[38;5;241m.[39mclient[38;5;241m.[39missue[38;5;241m.[39mupdate([38;5;28mself[39m[38;5;241m.[39mid, status_id[38;5;241m=[39mstatus_id, [38;5;241m*[39m[38;5;241m*[39mdata)
    [1;32m    579[0m [38;5;28mprint[39m([38;5;124mf[39m[38;5;124m"[39m[38;5;124mAtualizado para o status [39m[38;5;132;01m{[39;00mnew_status[38;5;132;01m}[39;00m[38;5;124m"[39m)

    File [0;32m~/anatel/fiscaliza/fiscaliza/main.py:539[0m, in [0;36mIssue._parse_value_dict[0;34m(self, dados)[0m
    [1;32m    537[0m data [38;5;241m=[39m {k: editable_fields[k](v) [38;5;28;01mfor[39;00m k, v [38;5;129;01min[39;00m data[38;5;241m.[39mitems()}
    [1;32m    538[0m submitted_fields [38;5;241m=[39m {[38;5;124m"[39m[38;5;124mcustom_fields[39m[38;5;124m"[39m: []}
    [0;32m--> 539[0m [38;5;28;01mif[39;00m uploads [38;5;241m:=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_check_uploads[49m[43m([49m[43mdados[49m[43m)[49m:
    [1;32m    540[0m     submitted_fields[[38;5;124m"[39m[38;5;124muploads[39m[38;5;124m"[39m] [38;5;241m=[39m uploads
    [1;32m    541[0m [38;5;28;01mfor[39;00m key, value [38;5;129;01min[39;00m data[38;5;241m.[39mitems():

    File [0;32m~/anatel/fiscaliza/fiscaliza/main.py:517[0m, in [0;36mIssue._check_uploads[0;34m(self, dados)[0m
    [1;32m    515[0m         [38;5;28;01mif[39;00m (path [38;5;241m:=[39m file[38;5;241m.[39mget([38;5;124m"[39m[38;5;124mpath[39m[38;5;124m"[39m)) [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
    [1;32m    516[0m             [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m Path(path)[38;5;241m.[39mis_file():
    [0;32m--> 517[0m                 [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m(
    [1;32m    518[0m                     [38;5;124mf[39m[38;5;124m"[39m[38;5;124mArquivo [39m[38;5;132;01m{[39;00mpath[38;5;132;01m}[39;00m[38;5;124m n√£o existe ou n√£o √© um arquivo[39m[38;5;124m"[39m
    [1;32m    519[0m                 )
    [1;32m    520[0m             uploads[38;5;241m.[39mappend(file)
    [1;32m    521[0m [38;5;28;01mreturn[39;00m uploads

    [0;31mValueError[0m: Arquivo C:\Users\rsilva\code\fiscaliza\tests\Report_2024.02.18_T11.30.55_123456.json n√£o existe ou n√£o √© um arquivo

## Gerar Relat√≥rio de Atividades

Para as inspe√ß√µes de `Certifica√ß√£o` e `Uso do Espectro - Monitora√ß√£o` √©
poss√≠vel gerar o relat√≥rio de atividades no SEI por meio do Fiscaliza,
para tal basta fornecer o valor:

    dados['gerar_relat√≥rio'] = '1'

``` python
dados['gerar_relatorio'] = '1'
issue.update(dados)
```

    Atualizado para o status Relatando

``` python
issue.attrs
```

    {'acao': {'type': 'acao_de_inspecao',
      'status': 'Em andamento',
      'name': 'ACAO_GR08_2024_0014',
      'description': '[PMEC 2024 Etapa 2] Monitorar canais e faixas de frequ√™ncias relacionados √†s aplica√ß√µes cr√≠ticas (como, por exemplo, radionavega√ß√£o e radiocomunica√ß√£o aeron√°utica e canais de emerg√™ncia) na forma a ser estabelecida no Plano de A√ß√£o de Fiscaliza√ß√£o.\r\n'},
     'agrupamento': '',
     'allowed_statuses': '',
     'anexos': ['https://sistemasnethm/fiscaliza/attachments/download/9190/Info.json'],
     'ano_de_execucao': 2024,
     'app_fiscaliza': 0,
     'assigned_to': 'Eric Magalh√£es Delgado',
     'atualizacao': 'Atualizada por Ronaldo da Silva Alves Batista em 25/07/2024 √†s 05:03:48',
     'author': 'Eric Magalh√£es Delgado',
     'changesets': '',
     'children': '',
     'classe_da_inspecao': 'T√©cnica',
     'closed_on': '',
     'coordenacao_responsavel': 'FI2',
     'created_on': '2024-04-18T12:38:03Z',
     'data_de_inicio_efetivo': '2024-07-25',
     'description': '[PMEC 2024 Etapa 2] Monitorar canais e faixas de frequ√™ncias relacionados √†s aplica√ß√µes cr√≠ticas (como, por exemplo, radionavega√ß√£o e radiocomunica√ß√£o aeron√°utica e canais de emerg√™ncia) na forma a ser estabelecida no Plano de A√ß√£o de Fiscaliza√ß√£o.\r\n',
     'done_ratio': 0,
     'due_date': '2024-05-30',
     'entidade_da_inspecao': [],
     'estimated_hours': '',
     'fiscais': ['Eric Magalh√£es Delgado', 'Ronaldo da Silva Alves Batista'],
     'fiscal_responsavel': 'Eric Magalh√£es Delgado',
     'horas_de_conclusao': 4,
     'horas_de_deslocamento': 3,
     'horas_de_execucao': 11,
     'horas_de_preparacao': 2,
     'id': 124182,
     'irregularidade': [],
     'is_private': False,
     'membros': ['Gilmar Ferreira do Nascimento',
      'Luis Fernando Camelier de Queiroz',
      'Michel Kulhavy Cerqueira',
      'Iulo de Ara√∫jo Lima Lobo',
      'Carlos Fernando Muniz Santos',
      'Isabel Cristina Cruz Soares e Souza',
      'Alessandro Vasconcelos Fernandes',
      'Anecy Oliveira de Freitas',
      'Wilton Machado de Oliveira',
      'Ilva Perla Monteiro Ferreira',
      'Lin Yu Wan',
      'Alexnaldo Cerqueira da Silva',
      'Jorgean Ferreira Leal',
      'Jos√© Mauricio Leite Ara√∫jo',
      'Arildo Oliva Franca Filho',
      'Leonardo Lago Ara√∫jo',
      'Brasilio Rios Leite',
      'Fiscal UD',
      'Jos√© Ivan Gomes',
      'Jaqueline Cesario da Silva',
      'Eric Magalh√£es Delgado',
      'Ronaldo da Silva Alves Batista'],
     'motivo_de_lai': ['Interfer√™ncia prejudicial'],
     'no_fiscaliza_issue': {'numero': '124182',
      'link_acesso': 'https://sistemasnethm/fiscaliza/issues/124182'},
     'no_pcdp': '',
     'no_sav': 'Teste de Quebra\n de linha',
     'no_sei_do_aviso_lai': '',
     'no_sei_do_plaiguarda': '',
     'no_sei_processo_fiscalizacao': "{'numero': '53554.000005/2024-18', 'link_acesso': 'https://seihm.anatel.gov.br/sei/controlador.php?acao=procedimento_trabalhar&id_procedimento=1982134'}",
     'numero_do_pai': 123456,
     'observacao_tecnica_amostral': 'Simula√ß√£o com o HTZ',
     'pai_instaurado_pela_anatel': 'Sim',
     'precisa_reservar_instrumentos': 0,
     'priority': 'Normal',
     'procedimentos': ['Emiss√£o Termo Viola√ß√£o de Lacre', 'Interrup√ß√£o'],
     'project': 'GR08',
     'servicos_da_inspecao': ['729 - COLETIVO - TV A CABO',
      '507 - RESTRITO - M√ìVEL AERON√ÅUTICO'],
     'situacao_constatada': 'Irregular',
     'spent_hours': 0.0,
     'start_date': '2024-03-01',
     'status': 'Relatando',
     'subject': 'INSP_GR08_2024_0147',
     'subtema': ['Radiomonitora√ß√£o Terrestre'],
     'tema': ['Uso do Espectro'],
     'time_entries': '',
     'tipo_de_inspecao': 'Outorga - Aspectos n√£o T√©cnicos',
     'total_de_horas': 20.0,
     'total_estimated_hours': '',
     'total_spent_hours': 0.0,
     'tracker': 'Atividade de Inspe√ß√£o',
     'ufmunicipio': ['MG/Baldim', 'PA/S√£o Jo√£o da Ponta'],
     'updated_on': '2024-07-25T08:03:48Z',
     'utilizou_algum_instrumento': 0,
     'utilizou_tecnicas_amostrais': 'Usou t√©cnicas amostrais',
     'watchers': ''}

> Para substituir o relat√≥rio de atividades, basta refazer a chamada
> fornecendo o valor `1` para a chave `gerar_relatorio`.

``` python
dados["gerar_relatorio"] = "1"
issue.update(dados)
```

    Atualizado para o status Relatando

``` python
issue.attrs
```

    {'acao': {'type': 'acao_de_inspecao',
      'status': 'Em andamento',
      'name': 'ACAO_GR08_2024_0014',
      'description': '[PMEC 2024 Etapa 2] Monitorar canais e faixas de frequ√™ncias relacionados √†s aplica√ß√µes cr√≠ticas (como, por exemplo, radionavega√ß√£o e radiocomunica√ß√£o aeron√°utica e canais de emerg√™ncia) na forma a ser estabelecida no Plano de A√ß√£o de Fiscaliza√ß√£o.\r\n'},
     'agrupamento': '',
     'allowed_statuses': '',
     'anexos': ['https://sistemasnethm/fiscaliza/attachments/download/9190/Info.json'],
     'ano_de_execucao': 2024,
     'app_fiscaliza': 0,
     'assigned_to': 'Eric Magalh√£es Delgado',
     'atualizacao': 'Atualizada por Ronaldo da Silva Alves Batista em 25/07/2024 √†s 05:03:48',
     'author': 'Eric Magalh√£es Delgado',
     'changesets': '',
     'children': '',
     'classe_da_inspecao': 'T√©cnica',
     'closed_on': '',
     'coordenacao_responsavel': 'FI2',
     'created_on': '2024-04-18T12:38:03Z',
     'data_de_inicio_efetivo': '2024-07-25',
     'description': '[PMEC 2024 Etapa 2] Monitorar canais e faixas de frequ√™ncias relacionados √†s aplica√ß√µes cr√≠ticas (como, por exemplo, radionavega√ß√£o e radiocomunica√ß√£o aeron√°utica e canais de emerg√™ncia) na forma a ser estabelecida no Plano de A√ß√£o de Fiscaliza√ß√£o.\r\n',
     'done_ratio': 0,
     'due_date': '2024-05-30',
     'entidade_da_inspecao': [],
     'estimated_hours': '',
     'fiscais': ['Eric Magalh√£es Delgado', 'Ronaldo da Silva Alves Batista'],
     'fiscal_responsavel': 'Eric Magalh√£es Delgado',
     'horas_de_conclusao': 4,
     'horas_de_deslocamento': 3,
     'horas_de_execucao': 11,
     'horas_de_preparacao': 2,
     'id': 124182,
     'irregularidade': [],
     'is_private': False,
     'membros': ['Gilmar Ferreira do Nascimento',
      'Luis Fernando Camelier de Queiroz',
      'Michel Kulhavy Cerqueira',
      'Iulo de Ara√∫jo Lima Lobo',
      'Carlos Fernando Muniz Santos',
      'Isabel Cristina Cruz Soares e Souza',
      'Alessandro Vasconcelos Fernandes',
      'Anecy Oliveira de Freitas',
      'Wilton Machado de Oliveira',
      'Ilva Perla Monteiro Ferreira',
      'Lin Yu Wan',
      'Alexnaldo Cerqueira da Silva',
      'Jorgean Ferreira Leal',
      'Jos√© Mauricio Leite Ara√∫jo',
      'Arildo Oliva Franca Filho',
      'Leonardo Lago Ara√∫jo',
      'Brasilio Rios Leite',
      'Fiscal UD',
      'Jos√© Ivan Gomes',
      'Jaqueline Cesario da Silva',
      'Eric Magalh√£es Delgado',
      'Ronaldo da Silva Alves Batista'],
     'motivo_de_lai': ['Interfer√™ncia prejudicial'],
     'no_fiscaliza_issue': {'numero': '124182',
      'link_acesso': 'https://sistemasnethm/fiscaliza/issues/124182'},
     'no_pcdp': '',
     'no_sav': 'Teste de Quebra\n de linha',
     'no_sei_do_aviso_lai': '',
     'no_sei_do_plaiguarda': '',
     'no_sei_processo_fiscalizacao': "{'numero': '53554.000005/2024-18', 'link_acesso': 'https://seihm.anatel.gov.br/sei/controlador.php?acao=procedimento_trabalhar&id_procedimento=1982134'}",
     'numero_do_pai': 123456,
     'observacao_tecnica_amostral': 'Simula√ß√£o com o HTZ',
     'pai_instaurado_pela_anatel': 'Sim',
     'precisa_reservar_instrumentos': 0,
     'priority': 'Normal',
     'procedimentos': ['Emiss√£o Termo Viola√ß√£o de Lacre', 'Interrup√ß√£o'],
     'project': 'GR08',
     'servicos_da_inspecao': ['729 - COLETIVO - TV A CABO',
      '507 - RESTRITO - M√ìVEL AERON√ÅUTICO'],
     'situacao_constatada': 'Irregular',
     'spent_hours': 0.0,
     'start_date': '2024-03-01',
     'status': 'Relatando',
     'subject': 'INSP_GR08_2024_0147',
     'subtema': ['Radiomonitora√ß√£o Terrestre'],
     'tema': ['Uso do Espectro'],
     'time_entries': '',
     'tipo_de_inspecao': 'Outorga - Aspectos n√£o T√©cnicos',
     'total_de_horas': 20.0,
     'total_estimated_hours': '',
     'total_spent_hours': 0.0,
     'tracker': 'Atividade de Inspe√ß√£o',
     'ufmunicipio': ['MG/Baldim', 'PA/S√£o Jo√£o da Ponta'],
     'updated_on': '2024-07-25T08:04:01Z',
     'utilizou_algum_instrumento': 0,
     'utilizou_tecnicas_amostrais': 'Usou t√©cnicas amostrais',
     'watchers': ''}

> Caso o intuito seja somente editar o campo `Relat√≥rio de Atividades`,
> basta fornecer o valor para a chave `relatorio_de_atividades` e n√£o
> esquecer de fornecer o valor `0` para a chave `gerar_relat√≥rio` ou
> simplesmente exclu√≠-la.

``` python
dados['relatorio_de_atividades'] = '0206885'
dados['gerar_relatorio'] = '0'
issue.update(dados)
```

    Atualizado para o status Relatando
