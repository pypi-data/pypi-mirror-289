- name: check if need bypass system package installation
  import_playbook: ../gather_installation_facts.yml

- name: sync time
  import_playbook: ../sync_time.yml

- name: install system dependencies
  import_playbook: ../install/install_sys_pkg.yml
  when: not skip_sys_pkg

- name: install driver and firmware
  import_playbook: ../install/install_npu.yml

- name: basic check
  import_playbook: ../check.yaml

- name: install docker
  import_playbook: ../docker.yaml

- name: config harbor info
  import_playbook: ../harbor.yaml
  when:
    - use_harbor

- name: install k8s
  import_playbook: ../k8s.yaml
  when: not skip_k8s_install

- name: install ascend-docker-runtime
  import_playbook: ../install/install_ascend-docker-runtime.yml

- name: install clusterd
  import_playbook: ../install/install_clusterd.yml

- name: install volcano
  import_playbook: ../install/install_volcano.yml
  when: not (scale | bool)

- name: install hccl-controller
  import_playbook: ../install/install_hccl-controller.yml

- name: install ascend-operator
  import_playbook: ../install/install_ascend-operator.yml

- name: install resilience-controller
  import_playbook: ../install/install_resilience-controller.yml

- name: install ascend-device-plugin
  import_playbook: ../install/install_ascend-device-plugin.yml

- name: install noded
  import_playbook: ../install/install_noded.yml

- name: install npu-exporter
  import_playbook: ../install/install_npu-exporter.yml