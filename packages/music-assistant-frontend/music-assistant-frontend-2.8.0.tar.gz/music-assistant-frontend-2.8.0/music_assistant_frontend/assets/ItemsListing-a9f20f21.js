import{an as x,ao as pe,l as ee,m as H,z as F,ap as Pe,v as dt,I as ft,f as k,E as vt,B as pt,aq as yt,r as V,G as X,d as te,c as n,e as f,u as h,a4 as K,b as ce,a5 as Te,ar as G,w as m,g as I,i as j,t as b,Y as A,j as y,_ as Q,M as D,as as ht,X as q,R as bt,Q as gt,a0 as wt,Z as kt,h as me,a1 as _t,a as _e,s as T,N as z,o as St,U as Se,al as It,F as Ie}from"./index-f6d6d5f3.js";import{V as Oe,M as Le,v as Ne,q as Me,c as J,u as De,f as $t,l as Z,w as Ct,k as Bt,p as $e}from"./VCheckbox-a96acb8a.js";import{_ as Vt}from"./eventbus-72e8654e.js";import{L as At}from"./ListItem-3a57b472.js";import{B as Re}from"./Button-0a6e461b.js";import{m as ye,b as he,h as Ft,o as Pt,t as Tt,v as Ot,c as Lt,w as Y,z as Nt,V as Mt,A as Dt,B as W,s as de}from"./VListItem-79e9844f.js";import{d as Rt,b as Et,c as fe,f as jt}from"./VMenu-5246b81b.js";import{_ as ae}from"./_plugin-vue_export-helper-c27b6911.js";import{V as Gt,b as Kt}from"./VCard-0040a03b.js";import{V as Yt}from"./VSpacer-c4203efd.js";import{V as Ut,P as Xt}from"./PanelviewItemCompact-bd25855a.js";import{V as zt}from"./VAlert-70136757.js";import{C as Ht}from"./Container-2a9ded95.js";import{T as Wt}from"./Toolbar-4dbf8f22.js";import{V as qt}from"./VTextField-c45341d1.js";import{V as Jt}from"./VList-bf612667.js";import{a as Qt,V as Zt}from"./VInfiniteScroll-be8bacb0.js";/* empty css              */import{V as xt}from"./VVirtualScroll-bf2c7c27.js";const Ee=(()=>x.reduce((i,a)=>(i[a]={type:[Boolean,String,Number],default:!1},i),{}))(),je=(()=>x.reduce((i,a)=>{const r="offset"+pe(a);return i[r]={type:[String,Number],default:null},i},{}))(),Ge=(()=>x.reduce((i,a)=>{const r="order"+pe(a);return i[r]={type:[String,Number],default:null},i},{}))(),Ce={col:Object.keys(Ee),offset:Object.keys(je),order:Object.keys(Ge)};function ea(i,a,r){let u=i;if(!(r==null||r===!1)){if(a){const l=a.replace(i,"");u+=`-${l}`}return i==="col"&&(u="v-"+u),i==="col"&&(r===""||r===!0)||(u+=`-${r}`),u.toLowerCase()}}const ta=["auto","start","end","center","baseline","stretch"],aa=ee({cols:{type:[Boolean,String,Number],default:!1},...Ee,offset:{type:[String,Number],default:null},...je,order:{type:[String,Number],default:null},...Ge,alignSelf:{type:String,default:null,validator:i=>ta.includes(i)},...ye(),...he()},"VCol"),Be=H()({name:"VCol",props:aa(),setup(i,a){let{slots:r}=a;const u=F(()=>{const l=[];let d;for(d in Ce)Ce[d].forEach(_=>{const e=i[_],g=ea(d,_,e);g&&l.push(g)});const S=l.some(_=>_.startsWith("v-col-"));return l.push({"v-col":!S||!i.cols,[`v-col-${i.cols}`]:i.cols,[`offset-${i.offset}`]:i.offset,[`order-${i.order}`]:i.order,[`align-self-${i.alignSelf}`]:i.alignSelf}),l});return()=>{var l;return Pe(i.tag,{class:[u.value,i.class],style:i.style},(l=r.default)==null?void 0:l.call(r))}}}),be=["start","end","center"],Ke=["space-between","space-around","space-evenly"];function ge(i,a){return x.reduce((r,u)=>{const l=i+pe(u);return r[l]=a(),r},{})}const la=[...be,"baseline","stretch"],Ye=i=>la.includes(i),Ue=ge("align",()=>({type:String,default:null,validator:Ye})),ia=[...be,...Ke],Xe=i=>ia.includes(i),ze=ge("justify",()=>({type:String,default:null,validator:Xe})),oa=[...be,...Ke,"stretch"],He=i=>oa.includes(i),We=ge("alignContent",()=>({type:String,default:null,validator:He})),Ve={align:Object.keys(Ue),justify:Object.keys(ze),alignContent:Object.keys(We)},sa={align:"align",justify:"justify",alignContent:"align-content"};function na(i,a,r){let u=sa[i];if(r!=null){if(a){const l=a.replace(i,"");u+=`-${l}`}return u+=`-${r}`,u.toLowerCase()}}const ra=ee({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:Ye},...Ue,justify:{type:String,default:null,validator:Xe},...ze,alignContent:{type:String,default:null,validator:He},...We,...ye(),...he()},"VRow"),Ae=H()({name:"VRow",props:ra(),setup(i,a){let{slots:r}=a;const u=F(()=>{const l=[];let d;for(d in Ve)Ve[d].forEach(S=>{const _=i[S],e=na(d,S,_);e&&l.push(e)});return l.push({"v-row--no-gutters":i.noGutters,"v-row--dense":i.dense,[`align-${i.align}`]:i.align,[`justify-${i.justify}`]:i.justify,[`align-content-${i.alignContent}`]:i.alignContent}),l});return()=>{var l;return Pe(i.tag,{class:["v-row",u.value,i.class],style:i.style},(l=r.default)==null?void 0:l.call(r))}}});const qe=Symbol.for("vuetify:v-item-group"),ua=ee({...ye(),...Ft({selectedClass:"v-item--selected"}),...he(),...dt()},"VItemGroup"),Je=H()({name:"VItemGroup",props:ua(),emits:{"update:modelValue":i=>!0},setup(i,a){let{slots:r}=a;const{themeClasses:u}=ft(i),{isSelected:l,select:d,next:S,prev:_,selected:e}=Pt(i,qe);return()=>k(i.tag,{class:["v-item-group",u.value,i.class],style:i.style},{default:()=>{var g;return[(g=r.default)==null?void 0:g.call(r,{isSelected:l,select:d,next:S,prev:_,selected:e.value})]}})}}),R=H()({name:"VItem",props:Tt(),emits:{"group:selected":i=>!0},setup(i,a){let{slots:r}=a;const{isSelected:u,select:l,toggle:d,selectedClass:S,value:_,disabled:e}=Ot(i,qe);return()=>{var g;return(g=r.default)==null?void 0:g.call(r,{isSelected:u.value,selectedClass:S.value,select:l,toggle:d,value:_.value,disabled:e.value})}}});const ca=ee({id:String,text:String,...vt(Rt({closeOnBack:!1,location:"end",locationStrategy:"connected",eager:!0,minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:!1}),["absolute","persistent"])},"VTooltip"),ve=H()({name:"VTooltip",props:ca(),emits:{"update:modelValue":i=>!0},setup(i,a){let{slots:r}=a;const u=pt(i,"modelValue"),{scopeId:l}=Et(),d=yt(),S=F(()=>i.id||`v-tooltip-${d}`),_=V(),e=F(()=>i.location.split(" ").length>1?i.location:i.location+" center"),g=F(()=>i.origin==="auto"||i.origin==="overlap"||i.origin.split(" ").length>1||i.location.split(" ").length>1?i.origin:i.origin+" center"),w=F(()=>i.transition?i.transition:u.value?"scale-transition":"fade-transition"),B=F(()=>X({"aria-describedby":S.value},i.activatorProps));return Lt(()=>{const L=fe.filterProps(i);return k(fe,X({ref:_,class:["v-tooltip",i.class],style:i.style,id:S.value},L,{modelValue:u.value,"onUpdate:modelValue":$=>u.value=$,transition:w.value,absolute:!0,location:e.value,origin:g.value,persistent:!0,role:"tooltip",activatorProps:B.value,_disableGlobalStack:!0},l),{activator:r.activator,default:function(){var E;for(var $=arguments.length,N=new Array($),P=0;P<$;P++)N[P]=arguments[P];return((E=r.default)==null?void 0:E.call(r,...N))??i.text}})}),jt({},_)}}),Qe=te({__name:"FavoriteButton",props:{item:{}},setup(i){const a=i;return(r,u)=>{var l;return n(),f(Re,X(a,{variant:"list",icon:(l=r.item)!=null&&l.favorite?"mdi-heart":"mdi-heart-outline",title:r.$t("tooltip.favorite"),onClick:[u[0]||(u[0]=d=>h(ce).toggleFavorite(r.item)),u[1]||(u[1]=K(()=>{},["prevent"])),u[2]||(u[2]=K(()=>{},["stop"]))]}),null,16,["icon","title"])}}}),ma={key:0,class:"media-thumb listitem-media-thumb"},da={key:1,class:"media-thumb listitem-media-thumb"},fa={key:0},va={key:1},pa={key:0},ya={key:0,class:"line-clamp-1"},ha={key:1},ba={key:0},ga={key:1},wa={key:2},ka={key:3},_a={key:4},Sa={key:5},Ia={key:2},$a={key:3},Ca={class:"text-caption",style:{"padding-right":"10px","padding-left":"10px"}},Ba=te({__name:"ListviewItem",props:{item:{},showTrackNumber:{type:Boolean,default:!0},showDiscNumber:{type:Boolean,default:!0},showPosition:{type:Boolean,default:!0},showProvider:{type:Boolean,default:!0},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavorite:{type:Boolean,default:!1},showDuration:{type:Boolean,default:!0},isSelected:{type:Boolean},isDisabled:{type:Boolean,default:!1},showCheckboxes:{type:Boolean,default:!1},showDetails:{type:Boolean}},emits:["menu","click","select"],setup(i,{emit:a}){const{t:r}=Te(),u=i,l=F(()=>{if(!("provider_mappings"in u.item))return"";for(const e of u.item.provider_mappings)if(e.audio_format&&e.audio_format.content_type!=null&&[G.DSF,G.FLAC,G.AIFF,G.WAV].includes(e.audio_format.content_type)&&(e.audio_format.sample_rate>48e3||e.audio_format.bit_depth>16))return`${e.audio_format.sample_rate/1e3}kHz ${e.audio_format.bit_depth} bits`;return""}),d=a,S=function(e){const g="clientX"in e?e.clientX:e.touches[0].clientX,w="clientY"in e?e.clientY:e.touches[0].clientY;d("menu",u.item,g,w)},_=function(e){u.showCheckboxes||d("click",u.item,e.clientX,e.clientY)};return(e,g)=>(n(),f(At,{link:"",disabled:!h(Z)(e.item)||e.isDisabled,"show-menu-btn":e.showMenu,onClick:K(_,["stop"]),onMenu:K(S,["stop"])},{prepend:m(()=>[e.showCheckboxes?(n(),I("div",ma,[k(Oe,{"model-value":e.isSelected,onClick:g[0]||(g[0]=K(()=>{},["stop"])),"onUpdate:modelValue":g[1]||(g[1]=w=>{w!=null&&d("select",e.item,w)})},null,8,["model-value"])])):(n(),I("div",da,[k(Le,{size:"50",item:e.item},null,8,["item"])]))]),title:m(()=>[e.item.media_type==h(D).FOLDER?(n(),I("span",fa,[j("span",null,b(h(Ne)(e.item,h(r))),1)])):(n(),I("span",va,[A(b(e.item.name)+" ",1),"version"in e.item&&e.item.version?(n(),I("span",pa,"("+b(e.item.version)+")",1)):y("",!0)])),e.item&&e.item.metadata?(n(),f(h(ve),{key:2,location:"bottom"},{activator:m(({props:w})=>[h(Me)(e.item.metadata.explicit||!1)?(n(),f(Y,X({key:0},w,{icon:"mdi-alpha-e-box",width:"35"}),null,16)):y("",!0)]),default:m(()=>[j("span",null,b(e.$t("tooltip.explicit")),1)]),_:1})):y("",!0)]),subtitle:m(()=>[e.item.media_type==h(D).TRACK&&"provider_mappings"in e.item?(n(),I("div",ya,[k(Je,null,{default:m(()=>["artists"in e.item?(n(),f(R,{key:0},{default:m(()=>[A(b(h(J)(e.item.artists,2)),1)]),_:1})):y("",!0),e.showAlbum&&"album"in e.item&&e.item.album?(n(),f(R,{key:1},{default:m(()=>[A(" • "+b(e.item.album.name),1)]),_:1})):y("",!0),e.showDiscNumber&&"disc_number"in e.item&&e.item.disc_number?(n(),f(R,{key:2},{default:m(()=>[k(Y,{style:{"margin-left":"5px"},icon:"md:album"}),A(" "+b(e.item.disc_number),1)]),_:1})):y("",!0),e.showTrackNumber&&"track_number"in e.item&&e.item.track_number?(n(),f(R,{key:3},{default:m(()=>[k(Y,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),A(" "+b(e.item.track_number),1)]),_:1})):e.showPosition&&"position"in e.item&&e.item.position?(n(),f(R,{key:4},{default:m(()=>[k(Y,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),A(" "+b(e.item.position),1)]),_:1})):y("",!0)]),_:1})])):e.item.media_type==h(D).ALBUM&&"year"in e.item?(n(),I("div",ha,[e.item.album_type!=h(ht).UNKNOWN?(n(),I("span",ba,b(e.$t("album_type."+e.item.album_type))+" • ",1)):y("",!0),j("span",null,b(h(J)(e.item.artists)),1),e.item.year?(n(),I("span",ga," • "+b(e.item.year),1)):y("",!0)])):"artists"in e.item&&e.item.artists?(n(),I("div",wa,b(h(J)(e.item.artists)),1)):"owner"in e.item&&e.item.owner?(n(),I("div",ka,b(e.item.owner),1)):e.item.media_type==h(D).RADIO&&e.item.metadata.description?(n(),I("div",_a,b(e.item.metadata.description),1)):"media_type"in e.item&&!e.item.provider_mappings?(n(),I("div",Sa,b(e.$t(e.item.media_type)),1)):y("",!0)]),append:m(()=>[l.value?(n(),f(Nt,{key:0,src:h(De),width:"30",class:Q(e.$vuetify.theme.current.dark?"hiresicondark":"hiresicon")},{default:m(()=>[k(h(ve),{activator:"parent",location:"bottom"},{default:m(()=>[A(b(l.value),1)]),_:1})]),_:1},8,["src","class"])):y("",!0),h(q)("bp2")&&e.showProvider?(n(),f(Vt,{key:1,domain:e.item.media_type==h(D).PLAYLIST?e.item.provider_mappings[0].provider_domain:e.item.provider,size:24},null,8,["domain"])):y("",!0),h(q)("bp3")&&"favorite"in e.item&&e.showFavorite&&!e.$vuetify.display.mobile?(n(),I("div",Ia,[k(Qe,{item:e.item},null,8,["item"])])):y("",!0),e.showDuration&&e.item.media_type==h(D).TRACK&&"duration"in e.item&&e.item.duration!=null&&h(q)("bp0")?(n(),I("div",$a,[j("div",null,[j("span",Ca,b(h($t)(e.item.duration)),1)])])):y("",!0)]),_:1},8,["disabled","show-menu-btn"]))}});const Va=ae(Ba,[["__scopeId","data-v-e9b09e11"]]),Aa={key:0},Fa={key:1},Pa={key:2},Ta=["src"],Oa={key:0},La=te({__name:"PanelviewItem",props:{item:{},size:{default:200},isSelected:{type:Boolean},showCheckboxes:{type:Boolean,default:!1},showMediaType:{type:Boolean,default:!1},showActions:{type:Boolean,default:!1}},emits:["menu","click","play","select"],setup(i,{emit:a}){const r=i,u=F(()=>{for(const e of r.item.provider_mappings)if(e.audio_format&&e.audio_format.content_type!=null&&[G.DSF,G.FLAC,G.AIFF,G.WAV].includes(e.audio_format.content_type)&&(e.audio_format.sample_rate>48e3||e.audio_format.bit_depth>16))return`${e.audio_format.sample_rate/1e3}kHz ${e.audio_format.bit_depth} bits`;return""}),l=a,d=function(e){if(r.showCheckboxes)return;const g="clientX"in e?e.clientX:e.touches[0].clientX,w="clientY"in e?e.clientY:e.touches[0].clientY;l("menu",r.item,g,w)},S=function(e){if(r.showCheckboxes){l("select",r.item,!r.isSelected);return}l("click",r.item,e.clientX,e.clientY)},_=function(e){r.showCheckboxes||l("play",r.item,e.clientX,e.clientY)};return(e,g)=>{const w=bt("hold");return n(),f(Ut,null,{default:m(({isHovering:B,props:L})=>[gt((n(),f(Gt,X(L,{tile:"",hover:"",class:"panel-item",disabled:!h(Z)(e.item),onClick:S,onContextmenu:K(d,["right","prevent"])}),{default:m(()=>[e.showCheckboxes?(n(),f(fe,{key:0,"model-value":e.showCheckboxes,contained:"",scrim:e.isSelected?e.$vuetify.theme.current.dark?"rgba(0,0,0,.75)":"rgba(255,255,255,.75)":"#ffffff00"},{default:m(()=>[k(Oe,{class:"panel-item-checkbox",ripple:!1,"model-value":e.isSelected},null,8,["model-value"])]),_:1},8,["model-value","scrim"])):y("",!0),k(Le,{item:e.item,style:{height:"auto"}},null,8,["item"]),k(Mt,{variant:"text",slim:"",tile:"",density:"compact",class:"panel-item-details"},{default:m(()=>[k(Dt,null,{default:m(()=>[e.item.media_type==h(D).FOLDER?(n(),I("span",Aa,[j("span",null,b(h(Ne)(e.item,e.$t)),1)])):(n(),I("span",Fa,b(e.item.name),1)),"version"in e.item&&e.item.version?(n(),I("span",Pa," - "+b(e.item.version),1)):y("",!0)]),_:1}),"artists"in e.item&&e.item.artists?(n(),f(W,{key:0,class:"line-clamp-1"},{default:m(()=>[A(b(h(J)(e.item.artists,1)),1)]),_:1})):"owner"in e.item&&e.item.owner?(n(),f(W,{key:1,class:"line-clamp-1"},{default:m(()=>[A(b(e.item.owner),1)]),_:1})):e.showMediaType?(n(),f(W,{key:2,class:"line-clamp-1"},{default:m(()=>[A(b(e.$t(e.item.media_type)),1)]),_:1})):(n(),f(W,{key:3,class:"line-clamp-1"}))]),_:1}),B||e.$vuetify.display.mobile?(n(),f(de,{key:1,icon:"mdi-play",color:"primary",fab:"",style:wt(`position: absolute; right: 15px; bottom: ${e.showActions?90:35}px; opacity: 0.8`),onClick:K(_,["stop"])},null,8,["style"])):y("",!0),e.showActions?(n(),f(Kt,{key:2,class:"panel-item-actions"},{default:m(()=>[k(Je,{style:{padding:"0"}},{default:m(()=>[h(Me)(e.item.metadata.explicit||!1)?(n(),f(R,{key:0},{default:m(()=>[k(Y,{size:"30",icon:"mdi-alpha-e-box"})]),_:1})):y("",!0),u.value?(n(),f(R,{key:1},{default:m(()=>[k(Y,{class:Q(e.$vuetify.theme.current.dark?"hiresicon":"hiresiconinverted")},{default:m(()=>[j("img",{src:h(De),width:"30"},null,8,Ta),k(ve,{activator:"parent",location:"bottom"},{default:m(()=>[A(b(u.value),1)]),_:1})]),_:1},8,["class"])]),_:1})):y("",!0),"track_number"in e.item&&e.item.track_number||"position"in e.item&&e.item.position?(n(),f(R,{key:2},{default:m(()=>[k(Y,{size:"small",icon:"mdi-music-circle-outline"}),e.item.disc_number?(n(),I("span",Oa,b(e.item.disc_number)+"/",1)):y("",!0),A(b(e.item.track_number||e.item.position),1)]),_:1})):y("",!0),h(q)("bp3")?(n(),f(R,{key:3},{default:m(()=>[k(Qe,{item:e.item},null,8,["item"])]),_:1})):y("",!0)]),_:1}),k(Yt),B||e.$vuetify.display.mobile?(n(),f(Re,{key:0,variant:"list",icon:"mdi-dots-vertical",style:{"padding-right":"0","margin-right":"-5px"},onClick:g[0]||(g[0]=K($=>e.$emit("menu",e.item,$.clientX,$.clientY),["stop"]))})):y("",!0)]),_:2},1024)):y("",!0)]),_:2},1040,["disabled"])),[[w,d]])]),_:1})}}});const Na=ae(La,[["__scopeId","data-v-fe19657b"]]),Ma={setup(i,a){const r=F(()=>({}));return{alertProps:F(()=>({...r.value,...a.attrs}))}}};function Da(i,a,r,u,l,d){return n(),f(zt,X(u.alertProps,{class:"alert",color:"primary",density:"compact",prominent:""}),kt({_:2},[me(i.$slots,(S,_)=>({name:_,fn:m(()=>[_t(i.$slots,_)])}))]),1040)}const Fe=ae(Ma,[["render",Da]]),Ra={key:0},Ea={key:1},ja=te({__name:"ItemsListing",props:{itemtype:{},sortKeys:{default:()=>["name","sort_name"]},showTrackNumber:{type:Boolean,default:!0},showProvider:{type:Boolean,default:Object.keys(ce.providers).length>1},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavoritesOnlyFilter:{type:Boolean,default:!0},showDuration:{type:Boolean,default:!0},parentItem:{default:void 0},showAlbumArtistsOnlyFilter:{type:Boolean},showSearchButton:{type:Boolean,default:void 0},showRefreshButton:{type:Boolean,default:void 0},showSelectButton:{type:Boolean,default:void 0},showAlbumTypeFilter:{type:Boolean,default:void 0},updateAvailable:{type:Boolean},title:{default:void 0},hideOnEmpty:{type:Boolean,default:!1},showLibraryOnlyFilter:{type:Boolean,default:!1},allowCollapse:{type:Boolean,default:!1},allowKeyHooks:{type:Boolean,default:!1},extraMenuItems:{default:void 0},loadPagedData:{type:Function,default:void 0},loadItems:{type:Function,default:void 0},limit:{default:50},total:{default:void 0},infiniteScroll:{type:Boolean,default:!0},path:{default:void 0},icon:{default:void 0},restoreState:{type:Boolean,default:!1}},setup(i){const a=i,r=It(),{t:u}=Te(),l=V({offset:0,limit:50,sortBy:"name",search:"",libraryOnly:!1}),d=V("list"),S=V(!1),_=V(!1),e=V([]),g=V([]),w=V(!1),B=V([]),L=V(!1),$=V(!1),N=V(!0),P=V(!1),E=V(!1),le=V(!1),Ze=function(){S.value?S.value=!1:(S.value=!0,Se(()=>{var t;(t=document.getElementById("searchInput"))==null||t.focus()}))},ie=function(){N.value=!N.value,localStorage.setItem(`expand.${a.path}.${a.itemtype}`,N.value.toString())},oe=function(t){d.value=t,localStorage.setItem(`viewMode.${a.path}.${a.itemtype}`,t)},xe=function(){l.value.favoritesOnly=!l.value.favoritesOnly;const t=l.value.favoritesOnly?"true":"false";localStorage.setItem(`favoriteFilter.${a.path}.${a.itemtype}`,t),O(void 0,void 0,!0)},et=function(){l.value.libraryOnly=!l.value.libraryOnly;const t=l.value.libraryOnly?"true":"false";localStorage.setItem(`libraryFilter.${a.path}.${a.itemtype}`,t),O(!0,void 0,!0)},tt=function(){l.value.albumArtistsFilter=!l.value.albumArtistsFilter;const t=l.value.albumArtistsFilter?"true":"false";localStorage.setItem(`albumArtistsFilter.${a.path}.${a.itemtype}`,t),O(void 0,void 0,!0)},se=function(t){return B.value.includes(t)},ne=function(t,s){if(s)B.value.includes(t)||B.value.push(t);else for(let o=0;o<B.value.length;o++)B.value[o]===t&&B.value.splice(o,1)},at=function(){$.value&&(B.value=[]),$.value=!$.value},lt=function(){O(!0,!0)},U=function(t,s,o){const v=Array.isArray(t)?t:[t];v[0].media_type!=D.FOLDER&&Bt(v,a.parentItem,s,o)},re=function(t,s,o){if(!Z(t)){U(t,s,o);return}t.media_type==D.FOLDER?r.push({name:"browse",query:{path:t.path}}):d.value=="list"&&t.media_type==D.TRACK&&a.parentItem?ue(t,s,o):r.push({name:t.media_type,params:{itemId:t.item_id,provider:t.provider}})},ue=function(t,s,o){if(!Z(t)){U(t,s,o);return}if(!T.activePlayerId){T.showPlayersMenu=!0;return}ce.playMedia(t.uri,void 0)},it=function(){l.value.search="",S.value=!1,O(void 0,void 0,!0)},ot=function(t){t!==void 0&&(l.value.sortBy=t),localStorage.setItem(`sortBy.${a.path}.${a.itemtype}`,l.value.sortBy),O(void 0,void 0,!0)},st=function(t){var s,o;(s=l.value.albumType)!=null&&s.includes(t)?l.value.albumType=(o=l.value.albumType)==null?void 0:o.filter(v=>v!==t):(l.value.albumType=l.value.albumType||[],l.value.albumType.push(t)),localStorage.setItem(`albumType.${a.path}.${a.itemtype}`,l.value.albumType.join(",")),O(void 0,void 0,!0)},nt=function(){T.globalSearchTerm=l.value.search,r.push({name:"search"})},rt=function({done:t}){if(P.value){t("empty");return}O(void 0,void 0,void 0,l.value.offset+a.limit).then(()=>{t("ok")})},we=F(()=>{var t=!1;return l.value.search&&l.value.search.length!==0&&(t=!0),t}),ut=F(()=>{var s,o;if(a.allowCollapse===!0&&!N.value)return[{label:"tooltip.collapse_expand",icon:"mdi-chevron-down",action:ie,overflowAllowed:!1}];const t=[];return a.showSelectButton!==!1&&t.push({label:"tooltip.select_items",icon:$.value?"mdi-checkbox-multiple-outline":"mdi-checkbox-multiple-blank-outline",action:at,active:$.value}),a.showLibraryOnlyFilter===!0&&t.push({label:"tooltip.filter_library",icon:"mdi-bookshelf",action:et,active:l.value.libraryOnly}),a.showFavoritesOnlyFilter===!0&&t.push({label:"tooltip.filter_favorites",icon:l.value.favoritesOnly?"mdi-heart":"mdi-heart-outline",action:xe,active:l.value.favoritesOnly}),a.showAlbumArtistsOnlyFilter===!0&&t.push({label:"tooltip.album_artist_filter",icon:l.value.albumArtistsFilter?"mdi-account-music":"mdi-account-music-outline",action:tt,active:l.value.albumArtistsFilter}),a.showAlbumTypeFilter&&t.push({label:"tooltip.album_type",icon:"mdi-album",disabled:w.value,subItems:["album","single","compilation","unknown"].map(v=>{var C;return{label:`album_type.${v}`,selected:(C=l.value.albumType)==null?void 0:C.includes(v),action:()=>{st(v)}}})}),(a.showRefreshButton!==!1||L.value)&&t.push({label:L.value?"tooltip.refresh_new_content":"tooltip.refresh",icon:"mdi-refresh",action:lt,active:L.value,disabled:w.value}),(s=a.sortKeys)!=null&&s.length&&t.push({label:"tooltip.sort_options",icon:"mdi-sort",disabled:a.sortKeys.length<=1||w.value,subItems:a.sortKeys.map(v=>({label:`sort.${v}`,selected:l.value.sortBy==v,action:()=>{ot(v)}}))}),a.showSearchButton!==!1&&t.push({label:we.value?"tooltip.search_filter_active":"tooltip.search",icon:"mdi-magnify",action:Ze,active:we.value,disabled:w.value}),t.push({label:"tooltip.toggle_view_mode",icon:d.value=="list"?"mdi-view-list":"mdi-grid",subItems:[{label:"view.list",icon:"mdi-view-list",selected:d.value=="list",action:()=>{oe("list")}},{label:"view.panel",icon:"mdi-grid",selected:d.value=="panel",action:()=>{oe("panel")}},{label:"view.panel_compact",icon:"mdi-grid",selected:d.value=="panel_compact",action:()=>{oe("panel_compact")}}]}),(o=a.extraMenuItems)!=null&&o.length&&t.push(...a.extraMenuItems),a.allowCollapse===!0&&t.push({label:"tooltip.collapse_expand",icon:"mdi-chevron-up",action:ie}),t}),O=async function(t=!1,s=!1,o=!1,v=0){if(!w.value){if(w.value=!0,o&&a.loadPagedData!=null&&(t=!0),(t||s)&&(v=0,P.value&&(le.value=!0),P.value=!1,E.value=!1,L.value=!1),l.value.offset=v,l.value.limit=a.limit,l.value.refresh=s,a.loadPagedData!=null){const C=await a.loadPagedData(l.value);l.value.offset?e.value.push(...C):e.value=C,Math.abs(C.length-a.limit)>10&&(P.value=!0)}else if(a.loadItems!=null){(!E.value||s)&&(g.value=await a.loadItems(l.value),E.value=!0);const C=mt(g.value,l.value);l.value.offset?e.value.push(...C):e.value=C,P.value=C.length<a.limit}l.value.refresh=!1,w.value=!1,le.value=!1}},ct=async function(){const t=`${a.path}.${a.itemtype}`,s=localStorage.getItem(`viewMode.${t}`);s&&s!=="null"?d.value=s:a.itemtype=="artists"||a.itemtype=="albums"?d.value="panel":d.value="list";const o=localStorage.getItem(`sortBy.${t}`);if(o&&o!=="null"&&a.sortKeys.includes(o)?l.value.sortBy=o:l.value.sortBy=a.sortKeys[0],a.showFavoritesOnlyFilter!==!1){const v=localStorage.getItem(`favoriteFilter.${t}`);v&&v=="true"&&(l.value.favoritesOnly=!0)}if(a.showLibraryOnlyFilter!==!1){const v=localStorage.getItem(`libraryFilter.${t}`);v&&v=="true"&&(l.value.libraryOnly=!0)}if(a.showAlbumArtistsOnlyFilter!==!1){const v=localStorage.getItem(`albumArtistsFilter.${t}`);v&&(l.value.albumArtistsFilter=v=="true")}if(a.allowCollapse!==!1){const v=localStorage.getItem(`expand.${t}`);v&&(N.value=v=="true")}if(a.showAlbumTypeFilter===!0){const v=localStorage.getItem(`albumType.${t}`);v&&(l.value.albumType=v.split(","))}if(a.restoreState){let v=`search.${t}`;a.parentItem&&(v+=a.parentItem.item_id);const C=localStorage.getItem(v);C&&C!=="null"&&(l.value.search=C)}},ke=function(t){T.dialogActive||w.value||(t.key==="a"&&(t.ctrlKey||t.metaKey)?(t.preventDefault(),B.value=e.value,$.value=!0):!_.value&&t.key=="Backspace"?l.value.search=l.value.search.slice(0,-1):!_.value&&t.key.length==1&&(l.value.search+=t.key,S.value=!0))};a.allowKeyHooks&&(document.addEventListener("keydown",ke),_e(()=>{document.removeEventListener("keydown",ke)})),a.restoreState&&_e(()=>{const t=a.path||a.itemtype,s=document.querySelector("#cont");T.prevState={path:t,scrollPos:(s==null?void 0:s.scrollTop)||0,pagedItems:e.value,allItems:g.value,allItemsReceived:P.value,initialDataReceived:E.value,params:l.value}}),z(()=>l.value.search,t=>{t&&(S.value=!0),O(void 0,void 0,!0);let s=`search.${a.path}.${a.itemtype}`;a.parentItem&&(s+=a.parentItem.item_id),localStorage.setItem(s,l.value.search)}),z(()=>a.path,t=>{w.value!=!0&&(e.value=[],g.value=[],O(!0))}),z(()=>a.parentItem,()=>{w.value!=!0&&(g.value=[],L.value=!0)},{deep:!0}),z(()=>a.limit,t=>{l.value.limit=t}),z(()=>a.updateAvailable,t=>{w.value||(L.value=t)},{immediate:!0}),St(async()=>{var s;ct();const t=a.path||a.itemtype;a.restoreState&&((s=T.prevState)==null?void 0:s.path)==t?(l.value=T.prevState.params,e.value=T.prevState.pagedItems,g.value=T.prevState.allItems,P.value=T.prevState.allItemsReceived,E.value=T.prevState.initialDataReceived,Se(()=>{const o=document.getElementById("cont");o&&Ct(o,T.prevState.scrollPos,50)}),w.value=!1):O(!0)});const M=function(t,s=!1){return t?"label"in t&&t.label&&t.name?u(t.label,[t.name]):"label"in t&&t.label?u(t.label):s&&"sort_name"in t&&t.sort_name?t.sort_name:t.name:""},mt=function(t,s){var v,C;let o=[];if(s.search){const p=s.search.toLowerCase();for(const c of t)(c.name.toLowerCase().includes(p)||"artist"in c&&((v=c.artist)!=null&&v.name.toLowerCase().includes(p))||"album"in c&&((C=c.album)!=null&&C.name.toLowerCase().includes(p))||"artists"in c&&c.artists&&c.artists.length&&c.artists[0].name.toLowerCase().includes(p))&&o.push(c)}else o=[...t];return s.sortBy=="name"&&o.sort((p,c)=>M(p).localeCompare(M(c),void 0,{numeric:!0})),s.sortBy=="sort_name"&&o.sort((p,c)=>M(p,!0).localeCompare(M(c,!0),void 0,{numeric:!0})),s.sortBy=="name_desc"&&o.sort((p,c)=>M(c).localeCompare(M(p),void 0,{numeric:!0})),s.sortBy=="album"&&o.sort((p,c)=>M(p.album).localeCompare(M(c.album),void 0,{numeric:!0})),s.sortBy=="artist"&&o.sort((p,c)=>M(p.artists[0]).localeCompare(M(c.artists[0]))),s.sortBy=="track_number"&&(o.sort((p,c)=>(p.track_number||0)-(c.track_number||0)),o.sort((p,c)=>(p.disc_number||0)-(c.disc_number||0))),s.sortBy=="position"&&o.sort((p,c)=>(p.position||0)-(c.position||0)),s.sortBy=="position_desc"&&o.sort((p,c)=>(c.position||0)-(p.position||0)),s.sortBy=="year"&&o.sort((p,c)=>(p.year||0)-(c.year||0)),s.sortBy=="recent"&&o.sort((p,c)=>(c.timestamp_added||0)-(p.timestamp_added||0)),s.sortBy=="duration"&&o.sort((p,c)=>(p.duration||0)-(c.duration||0)),s.sortBy=="duration_desc"&&o.sort((p,c)=>(c.duration||0)-(p.duration||0)),s.sortBy=="provider"&&o.sort((p,c)=>p.provider.localeCompare(c.provider)),s.favoritesOnly&&(o=o.filter(p=>p.favorite)),s.albumType&&s.albumType.length>0&&(o=o.filter(p=>{var c;return(c=s.albumType)==null?void 0:c.includes(p.album_type)})),o.slice(s.offset,s.offset+s.limit)};return(t,s)=>t.hideOnEmpty&&e.value.length==0?y("",!0):(n(),I("section",Ra,[k(Wt,{icon:t.icon,title:t.title,count:l.value.search?e.value.length:t.total||g.value.length,color:"transparent","menu-items":ut.value,onTitleClicked:ie},null,8,["icon","title","count","menu-items"]),k(Jt),S.value&&N.value?(n(),f(qt,{key:0,id:"searchInput",modelValue:l.value.search,"onUpdate:modelValue":s[0]||(s[0]=o=>l.value.search=o),clearable:"","prepend-inner-icon":"mdi-magnify",label:t.$t("search"),"hide-details":"",variant:"filled",style:{width:"auto","margin-top":"10px"},onFocus:s[1]||(s[1]=o=>_.value=!0),onBlur:s[2]||(s[2]=o=>_.value=!1),"onClick:clear":it},null,8,["modelValue","label"])):y("",!0),N.value?(n(),f(Ht,{key:1,variant:d.value=="list"?"default":"panel",style:{overflow:"hidden"}},{default:m(()=>[le.value?y("",!0):(n(),f(Qt,{key:0,onLoad:rt,mode:t.infiniteScroll?"intersect":"manual","load-more-text":t.$t("load_more_items"),"empty-text":"",style:{overflow:"hidden"}},{default:m(()=>[d.value=="panel"?(n(),f(Ae,{key:0},{default:m(()=>[(n(!0),I(Ie,null,me(e.value,o=>(n(),f(Be,{key:o.uri,cols:"12",class:Q(`col-${h($e)(t.$vuetify.display.width)}`)},{default:m(()=>[k(Na,{item:o,"is-selected":se(o),"show-checkboxes":$.value,"show-actions":["tracks","albums"].includes(t.itemtype),onSelect:ne,onMenu:U,onClick:re,onPlay:ue},null,8,["item","is-selected","show-checkboxes","show-actions"])]),_:2},1032,["class"]))),128))]),_:1})):y("",!0),d.value=="panel_compact"?(n(),f(Ae,{key:1},{default:m(()=>[(n(!0),I(Ie,null,me(e.value,o=>(n(),f(Be,{key:o.uri,cols:"12",class:Q(`col-${h($e)(t.$vuetify.display.width)}`)},{default:m(()=>[k(Xt,{item:o,"is-selected":se(o),"show-checkboxes":$.value,onSelect:ne,onMenu:U,onClick:re,onPlay:ue},null,8,["item","is-selected","show-checkboxes"])]),_:2},1032,["class"]))),128))]),_:1})):y("",!0),d.value=="list"?(n(),f(xt,{key:2,"item-height":70,height:"100%",items:e.value,style:{height:"100%",overflow:"hidden"}},{default:m(({item:o})=>[k(Va,{item:o,"show-track-number":t.showTrackNumber,"show-disc-number":t.showTrackNumber,"show-duration":t.showDuration,"show-favorite":t.showFavoritesOnlyFilter,"show-menu":t.showMenu,"show-provider":t.showProvider,"show-album":t.showAlbum,"show-checkboxes":$.value,"is-selected":se(o),"show-details":t.itemtype.includes("versions"),onSelect:ne,onMenu:U,onClick:re},null,8,["item","show-track-number","show-disc-number","show-duration","show-favorite","show-menu","show-provider","show-album","show-checkboxes","is-selected","show-details"])]),_:1},8,["items"])):y("",!0)]),_:1},8,["mode","load-more-text"])),!w.value&&e.value.length==0?(n(),I("div",Ea,[!w.value&&e.value.length==0&&(l.value.search||l.value.favoritesOnly)?(n(),f(Fe,{key:0,title:t.$t("no_content_filter")},{default:m(()=>[l.value.search?(n(),f(de,{key:0,style:{"margin-top":"15px"},onClick:nt},{default:m(()=>[A(b(t.$t("try_global_search")),1)]),_:1})):y("",!0)]),_:1},8,["title"])):!w.value&&e.value.length==0?(n(),f(Fe,{key:1},{default:m(()=>[A(b(t.$t("no_content")),1)]),_:1})):y("",!0)])):y("",!0),k(Zt,{"model-value":B.value.length>1,timeout:-1,style:{"margin-bottom":"120px"}},{actions:m(()=>[k(de,{color:"primary",variant:"text",onClick:s[3]||(s[3]=o=>U(B.value,o.clientX,o.clientY))},{default:m(()=>[A(b(t.$t("actions")),1)]),_:1})]),default:m(()=>[j("span",null,b(t.$t("items_selected",[B.value.length])),1)]),_:1},8,["model-value"])]),_:1},8,["variant"])):y("",!0)]))}});const sl=ae(ja,[["__scopeId","data-v-4cdeaf09"]]);export{sl as I,Ae as V,Be as a,ve as b};
