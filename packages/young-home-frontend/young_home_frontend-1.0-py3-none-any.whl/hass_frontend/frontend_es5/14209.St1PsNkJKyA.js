"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[14209],{34778:function(e,t,r){r.d(t,{K:function(){return n}});var n=function(e,t,r,n,i){return e.connection.subscribeMessage(i,{type:"threshold/start_preview",flow_id:t,flow_type:r,user_input:n})}},14209:function(e,t,r){var n=r(1781).A,i=r(94881).A;r.a(e,function(){var e=n(i().mark((function e(n,s){var a,o,u,d,c,l,h,v,f,k,p,_,w,b,y,A,x,m,g,M,P;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r.r(t),a=r(94881),o=r(1781),u=r(6238),d=r(36683),c=r(89231),l=r(29864),h=r(83647),v=r(8364),f=r(76504),k=r(80792),p=r(77052),_=r(43859),w=r(40924),b=r(196),y=r(34778),A=r(30165),x=r(47394),m=r(77664),!(g=n([A])).then){e.next=30;break}return e.next=26,g;case 26:e.t1=e.sent,e.t0=(0,e.t1)(),e.next=31;break;case 30:e.t0=g;case 31:A=e.t0[0],(0,v.A)([(0,b.EM)("flow-preview-threshold")],(function(e,t){var r,n=function(t){function r(){var t;(0,c.A)(this,r);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return t=(0,l.A)(this,r,[].concat(i)),e(t),t}return(0,h.A)(r,t),(0,d.A)(r)}(t);return{F:n,d:[{kind:"field",decorators:[(0,b.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,b.MZ)()],key:"flowType",value:void 0},{kind:"field",key:"handler",value:void 0},{kind:"field",decorators:[(0,b.MZ)()],key:"stepId",value:void 0},{kind:"field",decorators:[(0,b.MZ)()],key:"flowId",value:void 0},{kind:"field",decorators:[(0,b.MZ)()],key:"stepData",value:void 0},{kind:"field",decorators:[(0,b.wk)()],key:"_preview",value:void 0},{kind:"field",decorators:[(0,b.wk)()],key:"_error",value:void 0},{kind:"field",key:"_unsub",value:void 0},{kind:"method",key:"disconnectedCallback",value:function(){(0,f.A)((0,k.A)(n.prototype),"disconnectedCallback",this).call(this),this._unsub&&(this._unsub.then((function(e){return e()})),this._unsub=void 0)}},{kind:"method",key:"willUpdate",value:function(e){e.has("stepData")&&this._debouncedSubscribePreview()}},{kind:"method",key:"render",value:function(){return this._error?(0,w.qy)(M||(M=(0,u.A)(['<ha-alert alert-type="error">',"</ha-alert>"])),this._error):(0,w.qy)(P||(P=(0,u.A)(['<entity-preview-row .hass="','" .stateObj="','"></entity-preview-row>'])),this.hass,this._preview)}},{kind:"field",key:"_setPreview",value:function(){var e=this;return function(t){var r=(new Date).toISOString();e._preview=Object.assign({entity_id:"".concat(e.stepId,".___flow_preview___"),last_changed:r,last_updated:r,context:{id:"",parent_id:null,user_id:null}},t)}}},{kind:"field",key:"_debouncedSubscribePreview",value:function(){var e=this;return(0,x.s)((function(){e._subscribePreview()}),250)}},{kind:"method",key:"_subscribePreview",value:(r=(0,o.A)((0,a.A)().mark((function e(){return(0,a.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._unsub){e.next=6;break}return e.next=3,this._unsub;case 3:e.t0=e.sent,(0,e.t0)(),this._unsub=void 0;case 6:if("repair_flow"!==this.flowType){e.next=8;break}return e.abrupt("return");case 8:return e.prev=8,this._unsub=(0,y.K)(this.hass,this.flowId,this.flowType,this.stepData,this._setPreview),e.next=12,this._unsub;case 12:(0,m.r)(this,"set-flow-errors",{errors:{}}),e.next=20;break;case 15:e.prev=15,e.t1=e.catch(8),"string"==typeof e.t1.message?this._error=e.t1.message:(this._error=void 0,(0,m.r)(this,"set-flow-errors",e.t1.message)),this._unsub=void 0,this._preview=void 0;case 20:case"end":return e.stop()}}),e,this,[[8,15]])}))),function(){return r.apply(this,arguments)})}]}}),w.WF),s(),e.next=39;break;case 36:e.prev=36,e.t2=e.catch(0),s(e.t2);case 39:case"end":return e.stop()}}),e,null,[[0,36]])})));return function(t,r){return e.apply(this,arguments)}}())}}]);
//# sourceMappingURL=14209.St1PsNkJKyA.js.map